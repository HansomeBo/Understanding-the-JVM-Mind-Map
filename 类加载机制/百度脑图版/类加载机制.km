{"root":{"data":{"id":"67309c84a4d8","created":1564214401,"text":"类加载机制","expandState":"expand"},"children":[{"data":{"id":"bvtvqy4g2r40","created":1564214458805,"text":"加载","expandState":"collapse","priority":1},"children":[{"data":{"id":"bvtvqy4gq000","created":1564214458806,"text":"通过一个类的全限定名来获取定义此类的二进制字节流","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4h0sg0","created":1564214458806,"text":"来源","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4gojc0","created":1564214458806,"text":"Jar、EAR、WAR"},"children":[]},{"data":{"id":"bvtvqy4h3qo0","created":1564214458806,"text":"网络（Applet）"},"children":[]},{"data":{"id":"bvtvqy4gn8o0","created":1564214458806,"text":"运行时生成"},"children":[]},{"data":{"id":"bvtvqy4hn6o0","created":1564214458807,"text":"由其他文件生成"},"children":[]},{"data":{"id":"bvtvqy4hrns0","created":1564214458807,"text":"数据库中读取"},"children":[]}]},{"data":{"id":"bvtvqy4h80o0","created":1564214458807,"text":"类型","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4haj40","created":1564214458807,"text":"非数组类","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4heg00","created":1564214458807,"text":"通过loadClass()方法（可以通过重写的方式自定义此操作）"},"children":[]}]},{"data":{"id":"bvtvqy4i4rk0","created":1564214458808,"text":"数组类","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4ht740","created":1564214458808,"text":"Element type元素类型","expandState":"collapse"},"children":[{"data":{"id":"bvtwvwnlmzs0","created":1564217668540,"text":"去掉所有维度的类型"},"children":[]}]},{"data":{"id":"bvtvqy4i6600","created":1564214458808,"text":"Component Type组件类型","expandState":"collapse"},"children":[{"data":{"id":"bvtwwrfni2o0","created":1564217735540,"text":"去掉一个维度后的类型"},"children":[]}]},{"data":{"id":"bvtwx9o72fk0","created":1564217775238,"text":"如果Component是引用类型（自定义一个animal[],animal是一个自定义的引用类），递归加载，即一层一层的去掉维度，直到变成元素类型，之后数组animal在加载该组件类型的类加载器的类名称空间上被标识","priority":1},"children":[]},{"data":{"id":"bvtx23yypmg0","created":1564218154650,"text":"如果不是引用类型（如int[]），Java虚拟机把数组标记为与引导类加载器关联","priority":2},"children":[]},{"data":{"id":"bvtx1l9msyw0","created":1564218113936,"text":"可见性与组件类型的一致，如果组件类型不是引用类型，可见性默认设置为public","priority":3},"children":[]}]}]}]},{"data":{"id":"bvtvqy4i4e00","created":1564214458808,"text":"将这个字节流所代表的静态存储结构转换为方法区的运行时数据结构"},"children":[]},{"data":{"id":"bvtvqy4id880","created":1564214458808,"text":"在内存中生成一个代表这个类的java.lang.Class对象，作为方法区这个类的各种数据的访问入口","expandState":"collapse"},"children":[{"data":{"id":"bvtwuvp9rwo0","created":1564217588100,"text":"Class对象存在方法区"},"children":[]}]}]},{"data":{"id":"bvtvqy4hxko0","created":1564214458808,"text":"连接","expandState":"collapse","priority":2},"children":[{"data":{"id":"bvtvqy4isgg0","created":1564214458809,"text":"验证","expandState":"collapse"},"children":[{"data":{"id":"bvtxa750zg00","created":1564218788460,"text":"概念","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4isiw0","created":1564214458809,"text":"确保Class文件的字节流中包含的信息符合当前虚拟机的要求，并且不会危害虚拟机自身的安全"},"children":[]},{"data":{"id":"bvtxaq7nj1s0","created":1564218829977,"text":"将对象转型为未实现类型、跳转到不存在的代码行等","expandState":"expand"},"children":[{"data":{"id":"bvtxbjbqic80","created":1564218893351,"text":"编译器会拒绝编译"},"children":[]}]},{"data":{"id":"bvtxbt1doc80","created":1564218914493,"text":"但是Class文件不一定是Java编译来的，所以验证是必要的"},"children":[]}]},{"data":{"id":"bvtvqy4ieyw0","created":1564214458809,"text":"验证流程","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4ieo00","created":1564214458809,"text":"文件格式验证"},"children":[{"data":{"id":"bvtxci8w7zs0","created":1564218969367,"text":"查一下魔数对不对啊，版本号等等"},"children":[]}]},{"data":{"id":"bvtvqy4iu5k0","created":1564214458809,"text":"元数据验证"},"children":[{"data":{"id":"bvtxctx8wf40","created":1564218994784,"text":"分析语义对不对，有没有继承不能继承的类，如final修饰的类等等"},"children":[]}]},{"data":{"id":"bvtvqy4is9k0","created":1564214458809,"text":"字节码验证"},"children":[{"data":{"id":"bvtxdihecug0","created":1564219048245,"text":"会不会跳转到方法体外的字节码指令上啊，父类赋给子类，类型转换无效等"},"children":[]}]},{"data":{"id":"bvtvqy4jc5c0","created":1564214458810,"text":"符号引用验证"},"children":[{"data":{"id":"bvtxfrstbm80","created":1564219225255,"text":"符号引用转化为直接引用的时候"},"children":[]}]}]},{"data":{"id":"bvtvqy4j2gw0","created":1564214458810,"text":"jvm参数","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4jl280","created":1564214458811,"text":"-Xverify:none","expandState":"expand"},"children":[{"data":{"id":"bvtvqy4jofk0","created":1564214458811,"text":"关闭大部分的类验证措施，以缩短虚拟机类加载的时间"},"children":[]}]}]}]},{"data":{"id":"bvtvqy4jvow0","created":1564214458811,"text":"准备","expandState":"collapse"},"children":[{"data":{"id":"bvtyf5hxafs0","created":1564221997817,"text":"正式为类变量分配内存并设置类变量(static 变量)初始值(为0或false)，分配在方法区"},"children":[]},{"data":{"id":"bvtyvdiiax40","created":1564223269093,"text":"public static int value=123 准备阶段得到的值是0不是123"},"children":[]},{"data":{"id":"bvtyu3h55j40","created":1564223168878,"text":"如果字段属性表存在ConstantValue属性，如final修饰的，则在编译成Class时里面的ConstantValue已经有值，准备阶段会进行赋值"},"children":[]},{"data":{"id":"bvtyvt1o7m80","created":1564223302904,"text":"public static final int value=123 值为123"},"children":[]}]},{"data":{"id":"bvtvqy4jqa80","created":1564214458811,"text":"解析","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4kkdk0","created":1564214458812,"text":"概念"},"children":[{"data":{"id":"bvtvqy4kk3c0","created":1564214458812,"text":"解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程"},"children":[{"data":{"id":"bvtvqy4kme00","created":1564214458812,"text":"符号引用"},"children":[{"data":{"id":"bvtvqy4kp5c0","created":1564214458812,"text":"符号引用以一组符号来描述引用的目标，符号可以是任何形式的字面量，只要使用时能够无歧义的定位到目标即可。"},"children":[]}]},{"data":{"id":"bvtvqy4kei00","created":1564214458812,"text":"直接引用"},"children":[{"data":{"id":"bvtvqy4kl800","created":1564214458812,"text":"直接引用可以使直接指向目标的指针、相对偏移量或是一个能间接定位到目标的句柄。"},"children":[]},{"data":{"id":"bvu2fsjmk9k0","created":1564233332425,"text":"直接引用是与虚拟机内存相关的"},"children":[]}]}]}]},{"data":{"id":"bvtvqy4l6t40","created":1564214458813,"text":"流程"},"children":[{"data":{"id":"bvtvqy4l7yo0","created":1564214458813,"text":"类或接口的解析"},"children":[]},{"data":{"id":"bvtvqy4l9so0","created":1564214458813,"text":"字段解析"},"children":[]},{"data":{"id":"bvtvqy4l50w0","created":1564214458813,"text":"类方法解析"},"children":[]},{"data":{"id":"bvtvqy4l9qo0","created":1564214458813,"text":"接口方法解析"},"children":[]}]}]}]},{"data":{"id":"bvtvqy4li0g0","created":1564214458814,"text":"初始化","expandState":"collapse","priority":3},"children":[{"data":{"id":"bvtvqy4lozk0","created":1564214458814,"text":"概述","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4lirk0","created":1564214458814,"text":"到了初始化阶段，才真正开始执行类中定义的Java程序代码。"},"children":[]},{"data":{"id":"bvtvqy4lg3c0","created":1564214458814,"text":"初始化阶段是执行类构造器<clinit>()方法的过程"},"children":[]}]},{"data":{"id":"bvtvqy4lf880","created":1564214458814,"text":"种类","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4m2e80","created":1564214458815,"text":"类"},"children":[{"data":{"id":"bvtvqy4m0e80","created":1564214458815,"text":"初始化条件"},"children":[{"data":{"id":"bvtvqy4mfqo0","created":1564214458815,"text":"是","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4mly80","created":1564214458816,"text":"遇到字节码指令时"},"children":[{"data":{"id":"bvtvqy4n2v40","created":1564214458816,"text":"new"},"children":[]},{"data":{"id":"bvtvqy4mouw0","created":1564214458816,"text":"getstatic"},"children":[]},{"data":{"id":"bvtvqy4n11c0","created":1564214458816,"text":"putstatic"},"children":[]},{"data":{"id":"bvtvqy4ncxk0","created":1564214458817,"text":"invokestatic"},"children":[]}]},{"data":{"id":"bvu34yfvgdc0","created":1564235304363,"text":"使用java.lang.reflect包的方法进行反射调用"},"children":[]},{"data":{"id":"bvu35bzbv6w0","created":1564235333838,"text":"当初始化一个类时，如果父类没有初始化，调用父类初始化"},"children":[]},{"data":{"id":"bvu35vfo1vs0","created":1564235376185,"text":"启动时，初始化有main方法的类"},"children":[]}]},{"data":{"id":"bvtvqy4mggo0","created":1564214458815,"text":"否","expandState":"collapse"},"children":[{"data":{"id":"bvtvqy4mcuw0","created":1564214458815,"text":"被动引用"},"children":[{"data":{"id":"bvtvqy4md200","created":1564214458815,"text":"通过子类引用父类的静态字段，不会导致子类初始化"},"children":[]},{"data":{"id":"bvtvqy4mjnk0","created":1564214458816,"text":"通过数组定义来引用类，不会触发此类的初始化"},"children":[]},{"data":{"id":"bvtvqy4myv40","created":1564214458816,"text":"常量在编译阶段会存入调用类的常量池中，本质上并没有直接引用到定义常量的类，因此不会触发定义常量的类初始化"},"children":[]}]}]}]}]},{"data":{"id":"bvtvqy4n5800","created":1564214458817,"text":"接口"},"children":[]},{"data":{"id":"bvu38ro4d400","created":1564235603081,"text":"字段"},"children":[]},{"data":{"id":"bvu38t638w00","created":1564235606344,"text":"类方法"},"children":[]},{"data":{"id":"bvu38us4gcg0","created":1564235609853,"text":"接口方法"},"children":[]}]}]},{"data":{"id":"bvtvqy4nlh40","created":1564214458817,"text":"使用","priority":4},"children":[]},{"data":{"id":"bvtvqy4nfl40","created":1564214458817,"text":"卸载","priority":5},"children":[]}]},"template":"right","theme":"classic-compact","version":"1.4.43"}